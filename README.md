# As-Exploits v 1.2
中国蚁剑后渗透框架

详细介绍：http://yzddmr6.tk/posts/as-exploits/

支持类型：php/jsp/aspx

Payload部分很多借鉴了[冰蝎](https://github.com/rebeyond/Behinder)跟[哥斯拉](https://github.com/BeichenDream/Godzilla)的实现，向其开发者们表示感谢！

## 支持列表

| 模块名称\Shell类型 | PHP  | ASPX | JSP  |
| :---------------: | :--: | :--: | :--: |
|      基本信息      |  √   |  √   |  √   |
|     反弹Shell      |  √   |  √   |  √   |
|       内存马       |      |      |  √   |
|     内存马管理     |      |      |  √   |
|      杀软识别      |  √   |  √   |  √   |
|      提权辅助      |  √   |  √   |  √   |
|      屏幕截图      |      |  √   |  √   |
|  ShellCode加载器   |      |  √   |      |
|     Jar加载器      |      |      |  √   |



## 模块介绍

### 基本信息

获取当前服务端信息。

支持类型：php/jsp/aspx

php

![image-20201123102429650](README.assets/image-20201123102429650.png)

jsp

![image-20201123102711289](README.assets/image-20201123102711289.png)

aspx

![image-20210125203308842](README.assets/image-20210125203308842.png)

### 反弹Shell

跟MSF联动

支持类型：php/jsp/aspx

Payload目前支持以下类型：

* java/meterpreter/reverse_tcp

* java/shell/reverse_tcp

* java/meterpreter/bind_tcp

* java/shell/bind_tcp

* php/meterpreter/reverse_tcp

* php/shell/reverse_tcp

* php/meterpreter/bind_tcp

* php/shell/bind_tcp

* windows/meterpreter/reverse_tcp

* windows/x64/meterpreter/reverse_tcp

  ![image-20201123102902564](README.assets/image-20201123102902564.png)

### 内存马

一键打入内存Webshell，由于时间仓促，目前仅支持Servlet型内存马。

支持类型：jsp

可打入的内存马种类：

* AntSword

* Behinder

* Godzilla-Base64

* reGerog

  组件名称为注册的Servlet的名称，可以起一个具有迷惑性的名字来隐藏自己。

  其中AntSword类型支持Tomcat(5-9)、Spring。
  
  ![image-20201123103009090](README.assets/image-20201123103009090.png)
  
#### 打入哥斯拉内存马

  打入Godzilla-Base64内存马

![image-20201201202342251](README.assets/image-20201201202342251.png)

在哥斯拉中连接成功

![image-20201201202450941](README.assets/image-20201201202450941.png)

### 内存马管理

支持类型：jsp

* 获取当前Servlet
* 卸载指定Servlet

#### Tomcat

![image-20201123103108185](README.assets/image-20201123103108185.png)

#### Spring

![image-20210324152453888](README.assets/image-20210324152453888.png)

#### 卸载Servlet

以Spring为例，首先打入AntSword内存马

![image-20210324152722708](README.assets/image-20210324152722708.png)

获取Servlet，发现已经注入成功，并且在Servlet的第一位。

![image-20210324152730923](README.assets/image-20210324152730923.png)

测试，可以连接成功

![image-20210324152808884](README.assets/image-20210324152808884.png)

选择`卸载Servlet`，并输入相关信息

![image-20210324152822816](README.assets/image-20210324152822816.png)

再次获取Servlet，发现内存马已经被卸载

![image-20210324152904430](README.assets/image-20210324152904430.png)

### 杀软识别

> 数据来源是key师傅的项目：[avList](https://github.com/gh0stkey/avList)

通过`tasklist /svc`获取当前进程列表，识别出其中的杀软。

支持类型：php/jsp/aspx

目前支持手动跟自动两种获取方式：

* 自动获取

  自动执行`tasklist /svc`并分析回显数据。

* 手动获取

  手动输入`tasklist /svc`的结果。

  ![image-20201123103231582](README.assets/image-20201123103231582.png)

### 提权辅助

  通过`systeminfo`来获取补丁信息，从而给出提权建议。

  支持类型：php/jsp/aspx

  同样支持手动跟自动两种获取方式。

![image-20210125204039862](README.assets/image-20210125204039862.png)

### 屏幕截图

获取目标当前屏幕截图。

支持类型：jsp/aspx

![image-20210125204208942](README.assets/image-20210125204208942.png)

  ### ShellCode加载器

加载shellcode至内存运行。（shellcode为hex格式，且不能有多余空格或换行）

支持类型：aspx

以msf为例：msfvenom生成hex格式的shellcode

![image-20210125204629453](README.assets/image-20210125204629453.png)

粘贴进输入框，点击`exploit`

![image-20210125204523784](README.assets/image-20210125204523784.png)

收到Meterpreter会话

![image-20210125204322297](README.assets/image-20210125204322297.png)

  ### Jar加载器

加载Jar到JVM内存中。过程中文件不落地，可用于上传数据库驱动等。

支持类型：jsp

![image-20210324153258685](README.assets/image-20210324153258685.png)

## 更新日志

### v 1.2 (2021/3/24)

* aspx增加`屏幕截图`模块
* jsp增加`Jar加载器`模块。直接打入内存，文件不落地。
* 支持返回包加密
* `内存马管理`模块支持Tomcat（5-9）、Spring
* `内存马`模块中`AntSword`类型支持Tomcat（5-9）、Spring
* 报错信息优化

###  v 1.1 (2021/1/25)

- 增加对aspx类型的支持
- 增加`提权辅助`模块（aspx/jsp/php）
- 增加`屏幕截图`模块（jsp）
- 增加`shellcode加载器`模块（aspx）
- 仅展示当前类型可用模块，不可用模块不再显示

### v 1.0 (2020/12/1)

- release

## 注意事项

本插件仅供合法的渗透测试以及爱好者参考学习，请勿用于非法用途，否则自行承担相关责任。

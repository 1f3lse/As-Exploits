"use strict";

const WIN = require("ui/window"); // 窗口库

const Modules = ["base_info", "reverse_shell", "memory_shell", "memory_manage","av_list"]; //模块列表
/**
 * 插件类
 */
class Plugin {
  constructor(opt) {
    let self = this;
    self.opt = opt;
    self.core = new antSword["core"][opt["type"]](opt);
    let cores = {};
    Modules.map((_) => {
      cores[_] = require(`./core/${_}/index`);
    });
    self.cores = cores;
    // 创建一个 window
    let win = new WIN({
      title: `As_Exploits-${opt["ip"]}`,
      height: 650,
      width: 850,
    });
    this.win = win;
    self.main_layout = win.win.attachLayout("1C");
    self.main_cell = self.main_layout.cells("a");
    self.tabbar = self.main_cell.attachTabbar();
    self.tabbar.setAlign("left");
    self.cores_instance = [];
    for (let module of Modules) {
      self.cores_instance[module] = new self.cores[module](self);
      let instance = self.cores_instance[module];
      instance.setName(module);
      instance.createLayout(self.tabbar);
    }
  }
}

module.exports = Plugin;
